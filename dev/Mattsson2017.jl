using LinearAlgebra

# order 2
Qp = [
  -1//4 5//4 -1//2 0 0 0
  -1//4 -5//4 2 -1//2 0 0
  0 0 -3//2 2 -1//2 0
  0 0 0 -3//2 2 -1//2
  0 0 0 0 -5//4 5//4
  0 0 0 0 -1//4 -1//4
]
Qm = Matrix(-Qp')
B = zero(Qp); B[1,1] = -1; B[end,end] = 1
M = Diagonal([1//4, 5//4, 1, 1, 5//4, 1//4])
Dp = M \ (Qp + B / 2)
Dm = M \ (Qm + B / 2)

# order 3
Qp = [
  -1//12 3//4 -1//6 0 0 0
  -5//12 -5//12 1 -1//6 0 0
  0 -1//3 -1//2 1 -1//6 0
  0 0 -1//3 -1//2 1 -1//6
  0 0 0 -1//3 -5//12 3//4
  0 0 0 0 -5//12 -1//12
]
Qm = Matrix(-Qp')
B = zero(Qp); B[1,1] = -1; B[end,end] = 1
M = Diagonal([5//12, 13//12, 1, 1, 13//12, 5//12])
Dp = M \ (Qp + B / 2)
Dm = M \ (Qm + B / 2)

# order 4
Qp = [
    -1//48  205//288 -29//144   1//96   0      0      0     0     0 0 0
  -169//288 -11//48   33//32  -43//144  1//12  0      0     0     0 0 0
    11//144 -13//32  -29//48  389//288 -1//2   1//12  0     0     0 0 0
     1//32  -11//144 -65//288 -13//16  3//2   -1//2   1//12 0     0 0 0
     0        0        0       -1//4   -5//6   3//2  -1//2  1//12 0 0 0
     0        0        0        0      -1//4  -5//6   3//2 -1//2  1//12 0 0
  0 0 0 0 0 -1//4 -5//6 3//2 -1//2 1//12 0
  0 0 0 0 0 0 -1//4 -13//16 389//288 -43//144 1//96
  0 0 0 0 0 0 0 -65//288 -29//48 33//32 -29//144
  0 0 0 0 0 0 0 -11//144 -13//32 -11//48 205//288
  0 0 0 0 0 0 0 1//32 11//144 -169//288 -1//48
]
Qm = Matrix(-Qp')
B = zero(Qp); B[1,1] = -1; B[end,end] = 1
m = [49//144, 61//48, 41//48, 149//144]
M = Diagonal(vcat(m, ones(Int, size(Qp,1)-2*length(m)), m[end:-1:1]))
Dp = M \ (Qp + B / 2)
Dm = M \ (Qm + B / 2)
